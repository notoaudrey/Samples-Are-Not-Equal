
project: "cdc"
name: "cifar20-en-w5-s20-k80-f10-seed5"
method: "cdcv2"
method_kwargs:
  per_class_selected_num: 50
  super_cluster_num: 40
  w_en: 1.0

pretext:
  enable: True
  dir: trained_models/mocov2plus/k1m25ecy
  ckpt: mocov2plus-cifar20-all-k1m25ecy-ep=999.ckpt

back_epoch: 0
epsilon: 0.1

window_size: 5
start_epoch: 20
keep_ratio: 0.8
update: 10

cdc_checkpoint: save/cdc/cifar20/cifar20-en-w5-s10-k80-f10-seed5/checkpoint.pth.tar
best_checkpoint: save/cdc/cifar20/cifar20-en-w5-s10-k80-f10-seed5/best_model.pth.tar
cdc_dir: save/cdc/cifar20/cifar20-en-w5-s10-k80-f10-seed5/

backbone:
  name: "resnet34"
  nheads: 1
  nclusters: 20
  feat_dim: 512
data:
  dataset: cifar20
  train_path: "/nas/datasets" #
  val_path: "/nas/datasets" #
  num_workers: 8
  split: 'train+test'
optimizer:
  name: "adam"
  batch_size: 1000
  sub_batch_size: 500
  lr: 0.00001
  elr: 0.00001
  kwargs:
    weight_decay: 0.000
scheduler:
  name: constant
max_epochs: 100

cluster_eval:
  plot_freq: 10
  plot_title: 'CDC'
  eval_freq: 1
  select_conf: 0.9999999
augmentation_strong:
  crop_size: 32
  normalize:
    mean: [0.5071, 0.4865, 0.4409]
    std: [0.2673, 0.2564, 0.2762]
  num_strong_augs: 4
  cutout_kwargs:
    n_holes: 1
    length: 16
    random: True
augmentation_stantard:
  random_resized_crop:
    size: 32
  normalize:
    mean: [0.5071, 0.4865, 0.4409]
    std: [0.2673, 0.2564, 0.2762]
augmentation_val:
  crop_size: 32
  normalize:
    mean: [0.5071, 0.4865, 0.4409]
    std: [0.2673, 0.2564, 0.2762]