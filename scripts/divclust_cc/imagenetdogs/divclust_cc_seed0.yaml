
project: "divclust_cc_v1"
name: "imagenetdogs-divclust_cc-all-seed0"
method: "divclust_cc"
method_kwargs:
  entropy_loss_weight: 1.0

pretext:
  enable: True
  dir: /nas/cjh/solo-learn/trained_models/mocov2plus/js77a3b3
  ckpt: mocov2plus-imagenetdogs-2-js77a3b3-ep=999.ckpt

divclust_cc_checkpoint: save/divclust_cc/imagenetdogs/imagenetdogs-divclust_cc-all-seed0/checkpoint.pth.tar
best_checkpoint: save/divclust_cc/imagenetdogs/imagenetdogs-divclust_cc-all-seed0/best_model.pth.tar
divclust_cc_dir: save/divclust_cc/imagenetdogs/imagenetdogs-divclust_cc-all-seed0/

clusterings: 20
NMI_target: 0.8
NMI_interval: 20
threshold_rate: 0.99
divclust_mbank_size: 10000

backbone:
  name: "resnet34"
  nheads: 1
  nclusters: 15
  feat_dim: 512

data:
  dataset: imagenetdogs
  train_path: "/nas/datasets/imagenetdogs" #
  val_path: "/nas/datasets/imagenetdogs" #
  num_workers: 8
  split: 'train'

optimizer:
  name: "adam"
  batch_size: 256
  lr: 0.00001
  kwargs:
    weight_decay: 0.0000

scheduler:
  name: constant

criterion:
  name: divclust_cc
  instance_temperature: 0.5
  cluster_temperature: 1.0
  
max_epochs: 200

cluster_eval:
  plot_freq: 10
  plot_title: 'divclust_cc'
  eval_freq: 10

  select_enable: True
  select_freq: 5
  select_conf: 0.99

augmentation_strong:
  crop_size: 224
  normalize:
    mean: [0.485, 0.456, 0.406]
    std: [0.229, 0.224, 0.225]
  num_strong_augs: 4
  cutout_kwargs:
    n_holes: 1
    length: 32
    random: True
augmentation_stantard:
  random_resized_crop:
    size: 224
  normalize:
    mean: [0.485, 0.456, 0.406]
    std: [0.229, 0.224, 0.225]
augmentation_val:
  crop_size: 224
  normalize:
    mean: [0.485, 0.456, 0.406]
    std: [0.229, 0.224, 0.225]
